FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGFlcm9nZWFyLWRpZ2dlci1hcGIKZGVzY3JpcHRpb246IE1vYmls\
ZSBDSXxDRCBzZXJ2aWNlIHRoYXQgaW50ZWdyYXRlcyB3aXRoIEplbmtpbnMgUGlwZWxpbmVzIHRv\
IHRlc3QgYW5kIGJ1aWxkIHlvdXIgbW9iaWxlIGJpbmFyaWVzLgpiaW5kYWJsZTogRmFsc2UKYXN5\
bmM6IG9wdGlvbmFsCnRhZ3M6CiAgLSBtb2JpbGUtc2VydmljZQptZXRhZGF0YToKICBkaXNwbGF5\
TmFtZTogTW9iaWxlIENJfENECiAgbG9uZ0Rlc2NyaXB0aW9uOiAiVG8gdXNlIHRoZSBNb2JpbGUg\
Q0l8Q0Qgc2VydmljZSB5b3UgbXVzdCBmaXJzdCBhZ3JlZSB0byB0aGUgQW5kcm9pZCBTREsgTGlj\
ZW5zZSBBZ3JlZW1lbnQuIEJ5IGNoZWNraW5nIHRoaXMgYm94IHlvdSBhcmUgYWdyZWVpbmcgdG8g\
dGhlIEFuZHJvaWQgU29mdHdhcmUgRGV2ZWxvcG1lbnQgS2l0IExpY2Vuc2UgYWdyZWVtZW50IHdo\
aWNoIGNhbiBiZSByZWFkIGF0IHRoZSBmb2xsb3dpbmcgVVJMOiBodHRwczovL2RldmVsb3Blci5h\
bmRyb2lkLmNvbS9zdHVkaW8vdGVybXMuaHRtbFxuXG4uIElmIHRoZSBib3ggaXMgbm90IGNoZWNr\
ZWQgdGhlIGluc3RhbGxlciB3aWxsIHRha2Ugbm8gYWN0aW9uLiIKICBzZXJ2aWNlTmFtZTogYWVy\
b2dlYXItZGlnZ2VyCiAgaW1hZ2VVcmw6ICJodHRwczovL2Flcm9nZWFyLm9yZy9pbWcvYWVyb2dl\
YXJkaWdnZXJfaWNvbl8zMnB4X2Nyb3BwZWQucG5nIgogIGRvY3VtZW50YXRpb25Vcmw6ICJodHRw\
czovL2Flcm9nZWFyLm9yZy9kaWdnZXIvIgogIHByb3ZpZGVyRGlzcGxheU5hbWU6ICJSZWQgSGF0\
LCBJbmMuIgpwbGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBEZWZhdWx0\
IHBsYW4KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOiB7fQogICAgcGFyYW1ldGVyczoKICAg\
IC0gbmFtZTogQU5EUk9JRF9MSUNFTlNFX0FHUkVFTUVOVAogICAgICBkZWZhdWx0OiAiIgogICAg\
ICBwYXR0ZXJuOiBeeWVzJAogICAgICB0eXBlOiBzdHJpbmcKICAgICAgZGVzY3JpcHRpb246ICJU\
eXBlICd5ZXMnIGFib3ZlIHRvIGFjY2VwdCB0aGUgQW5kcm9pZCBTREsgTGljZW5zZSBBZ3JlZW1l\
bnQuIGh0dHBzOi8vZGV2ZWxvcGVyLmFuZHJvaWQuY29tL3N0dWRpby90ZXJtcy5odG1sIgogICAg\
ICB0aXRsZTogQW5kcm9pZCBTREsgTGljZW5zZSBBZ3JlZW1lbnQKICAgICAgcmVxdWlyZWQ6IFRy\
dWUKICAgICAgZGlzcGxheV9ncm91cDogQW5kcm9pZCBTREsKICAgIC0gbmFtZTogQU5EUk9JRF9T\
REtfQ09ORklHCiAgICAgIGRlZmF1bHQ6IHwKICAgICAgICBbYmFzZV0KICAgICAgICB0b29scwog\
ICAgICAgIHBsYXRmb3JtLXRvb2xzCiAKICAgICAgICBbcGxhdGZvcm1zXQogICAgICAgIGFuZHJv\
aWQtMjcKICAgICAgICBhbmRyb2lkLTI2CiAgICAgICAgYW5kcm9pZC0yNQogICAgICAgICAKICAg\
ICAgICBbYnVpbGQtdG9vbHNdCiAgICAgICAgMjcuMC4zCiAgICAgICAgMjcuMC4yCiAgICAgICAg\
MjcuMC4xCiAgICAgICAgMjYuMC4yCiAgICAgICAgMjYuMC4xCiAgICAgICAgMjYuMC4wCiAgICAg\
ICAgMjUuMC4zCiAgICAgICAgMjUuMC4yCiAgICAgICAgIAogICAgICAgIFtleHRyYXM6Z29vZ2xl\
XQogICAgICAgIGdvb2dsZV9wbGF5X3NlcnZpY2VzCiAgICAgICAgbTJyZXBvc2l0b3J5CiAgICAg\
ICAgIAogICAgICAgIFtleHRyYXM6YW5kcm9pZF0KICAgICAgICBtMnJlcG9zaXRvcnkKICAgICAg\
ICAgCiAgICAgICAgW2V4dHJhczptMnJlcG9zaXRvcnk6Y29tOmFuZHJvaWQ6c3VwcG9ydDpjb25z\
dHJhaW50OmNvbnN0cmFpbnQtbGF5b3V0XQogICAgICAgIDEuMC4wCiAgICAgICAgMS4wLjEKICAg\
ICAgICAxLjAuMgogICAgICAgICAKICAgICAgICBbZXh0cmFzOm0ycmVwb3NpdG9yeTpjb206YW5k\
cm9pZDpzdXBwb3J0OmNvbnN0cmFpbnQ6Y29uc3RyYWludC1sYXlvdXQtc29sdmVyXQogICAgICAg\
IDEuMC4wCiAgICAgICAgMS4wLjIKICAgICAgICAgCiAgICAgICAgW2tleXN0b3JlXQogICAgICAg\
IGFsaWFzPUFuZHJvaWREZWJ1Z0tleQogICAgICAgIG5hbWU9QUcKICAgICAgICB1bml0PUFlcm9H\
ZWFyCiAgICAgICAgb3JnPVJlZEhhdAogICAgICAgIGxvYz1XYXRlcmZvcmQKICAgICAgICBzdGF0\
ZT1XRAogICAgICAgIGNvdW50cnk9SVJMCiAgICAgICAgc3RvcmVwYXNzPWFuZHJvaWQKICAgICAg\
ICBrZXlwYXNzPWFuZHJvaWQKICAgICAgdHlwZTogc3RyaW5nCiAgICAgIGRpc3BsYXlfdHlwZTog\
dGV4dGFyZWEKICAgICAgZGVzY3JpcHRpb246ICJBbmRyb2lkIFNESyBjb25maWcgY29udGVudCIK\
ICAgICAgdGl0bGU6IEFuZHJvaWQgU0RLIHBhY2thZ2UgY29uZmlnCiAgICAgIHJlcXVpcmVkOiBG\
YWxzZQogICAgICB1cGRhdGFibGU6IFRydWUKICAgICAgZGlzcGxheV9ncm91cDogQW5kcm9pZCBT\
REsK"

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
